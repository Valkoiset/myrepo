{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import gym"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# env = gym.make('CartPole-v0')\n",
    "# env.reset()\n",
    "# for _ in range(1000):\n",
    "#     env.render()\n",
    "#     env.step(env.action_space.sample()) # take a random action\n",
    "# env.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-0.03770531 -0.01886435 -0.04378216 -0.02915637]\n",
      "[-0.03808259  0.17685723 -0.04436529 -0.33532525]\n",
      "[-0.03454545  0.37258157 -0.0510718  -0.641662  ]\n",
      "[-0.02709382  0.56837685 -0.06390504 -0.94998056]\n",
      "[-0.01572628  0.37417062 -0.08290465 -0.67804115]\n",
      "[-0.00824287  0.57034054 -0.09646547 -0.99563141]\n",
      "[ 0.00316394  0.37663181 -0.1163781  -0.7347361 ]\n",
      "[ 0.01069658  0.18329345 -0.13107282 -0.48082822]\n",
      "[ 0.01436245  0.37999838 -0.14068938 -0.81177985]\n",
      "[ 0.02196242  0.57673828 -0.15692498 -1.14520026]\n",
      "[ 0.03349718  0.77352237 -0.17982899 -1.48269623]\n",
      "Episode finished after 11 timesteps\n",
      "[-0.03061318 -0.04274607  0.04652676 -0.0007776 ]\n",
      "[-0.0314681   0.15167881  0.04651121 -0.27842539]\n",
      "[-0.02843452 -0.04407474  0.0409427   0.02855676]\n",
      "[-0.02931602  0.15043688  0.04151384 -0.25093236]\n",
      "[-0.02630728  0.34494218  0.03649519 -0.53023738]\n",
      "[-0.01940844  0.14932637  0.02589045 -0.22628183]\n",
      "[-0.01642191  0.34406892  0.02136481 -0.51068683]\n",
      "[-0.00954053  0.14865262  0.01115107 -0.2113485 ]\n",
      "[-0.00656748  0.34361337  0.0069241  -0.5004931 ]\n",
      "[ 0.00030479  0.1483945  -0.00308576 -0.20563614]\n",
      "[ 0.00327268 -0.04668319 -0.00719848  0.08607179]\n",
      "[ 0.00233901  0.1485412  -0.00547705 -0.20887355]\n",
      "[ 0.00530984  0.34374104 -0.00965452 -0.50327916]\n",
      "[ 0.01218466  0.14875649 -0.0197201  -0.21365434]\n",
      "[ 0.01515979 -0.04607806 -0.02399319  0.07274332]\n",
      "[ 0.01423823  0.1493795  -0.02253832 -0.22741196]\n",
      "[ 0.01722582  0.34481618 -0.02708656 -0.52711822]\n",
      "[ 0.02412214  0.54030857 -0.03762892 -0.82821171]\n",
      "[ 0.03492831  0.34572073 -0.05419316 -0.54759687]\n",
      "[ 0.04184273  0.15140034 -0.0651451  -0.2724692 ]\n",
      "[ 0.04487073 -0.04273449 -0.07059448 -0.00102376]\n",
      "[ 0.04401604  0.15332515 -0.07061496 -0.31511826]\n",
      "[ 0.04708255 -0.04072359 -0.07691732 -0.04551411]\n",
      "[ 0.04626808  0.15541223 -0.0778276  -0.36143937]\n",
      "[ 0.04937632 -0.03852219 -0.08505639 -0.09427653]\n",
      "[ 0.04860588 -0.23232858 -0.08694192  0.17040566]\n",
      "[ 0.0439593  -0.42610548 -0.08353381  0.43444442]\n",
      "[ 0.03543719 -0.61995162 -0.07484492  0.69966935]\n",
      "[ 0.02303816 -0.81396053 -0.06085153  0.96788413]\n",
      "[ 0.00675895 -1.00821495 -0.04149385  1.24084713]\n",
      "[-0.01340535 -0.81258554 -0.01667691  0.93545991]\n",
      "[-0.02965706 -1.00747864  0.00203229  1.22285612]\n",
      "[-0.04980663 -1.20262671  0.02648941  1.51617512]\n",
      "[-0.07385916 -1.39805895  0.05681292  1.81700761]\n",
      "[-0.10182034 -1.59376486  0.09315307  2.12678686]\n",
      "[-0.13369564 -1.78968053  0.1356888   2.44673365]\n",
      "[-0.16948925 -1.59595009  0.18462348  2.19857924]\n",
      "Episode finished after 37 timesteps\n",
      "[ 0.02804216 -0.01941928 -0.03518053 -0.03800066]\n",
      "[ 0.02765378 -0.21401954 -0.03594055  0.24337817]\n",
      "[ 0.02337339 -0.01840315 -0.03107298 -0.06042117]\n",
      "[ 0.02300532 -0.21306612 -0.03228141  0.22229834]\n",
      "[ 0.018744   -0.01749799 -0.02783544 -0.0803901 ]\n",
      "[ 0.01839404  0.1780117  -0.02944324 -0.38172359]\n",
      "[ 0.02195428  0.37353908 -0.03707771 -0.68354261]\n",
      "[ 0.02942506  0.56915573 -0.05074857 -0.98766426]\n",
      "[ 0.04080817  0.7649191  -0.07050185 -1.29584495]\n",
      "[ 0.05610655  0.57076    -0.09641875 -1.02604017]\n",
      "[ 0.06752175  0.76702421 -0.11693955 -1.34737233]\n",
      "[ 0.08286224  0.57355016 -0.143887   -1.09344522]\n",
      "[ 0.09433324  0.77024412 -0.1657559  -1.42759419]\n",
      "[ 0.10973812  0.96697998 -0.19430779 -1.76716266]\n",
      "Episode finished after 14 timesteps\n",
      "[ 0.02528176  0.01082379 -0.0380709   0.04029011]\n",
      "[ 0.02549824  0.20647041 -0.0372651  -0.2641573 ]\n",
      "[ 0.02962764  0.01189962 -0.04254825  0.01654284]\n",
      "[ 0.02986564 -0.18258713 -0.04221739  0.29550353]\n",
      "[ 0.02621389 -0.37708258 -0.03630732  0.57457854]\n",
      "[ 0.01867224 -0.18147094 -0.02481575  0.27068244]\n",
      "[ 0.01504282 -0.37623014 -0.0194021   0.55543621]\n",
      "[ 0.00751822 -0.18084123 -0.00829338  0.25670414]\n",
      "[ 0.0039014   0.01439814 -0.00315929 -0.03858306]\n",
      "[ 0.00418936  0.20956525 -0.00393096 -0.3322611 ]\n",
      "[ 0.00838066  0.01449947 -0.01057618 -0.04082039]\n",
      "[ 0.00867065  0.20977148 -0.01139259 -0.33682135]\n",
      "[ 0.01286608  0.01481349 -0.01812901 -0.0477527 ]\n",
      "[ 0.01316235  0.21019064 -0.01908407 -0.3460999 ]\n",
      "[ 0.01736616  0.01534528 -0.02600606 -0.05949546]\n",
      "[ 0.01767307  0.21083027 -0.02719597 -0.36026871]\n",
      "[ 0.02188968  0.40632803 -0.03440135 -0.66140155]\n",
      "[ 0.03001624  0.21170123 -0.04762938 -0.37974607]\n",
      "[ 0.03425026  0.40746605 -0.0552243  -0.68705804]\n",
      "[ 0.04239958  0.21315238 -0.06896546 -0.41225957]\n",
      "[ 0.04666263  0.40918073 -0.07721065 -0.72586287]\n",
      "[ 0.05484624  0.60528058 -0.09172791 -1.04181368]\n",
      "[ 0.06695186  0.80149322 -0.11256418 -1.36182551]\n",
      "[ 0.08298172  0.99783141 -0.13980069 -1.68749298]\n",
      "[ 0.10293835  1.19426607 -0.17355055 -2.02023794]\n",
      "Episode finished after 25 timesteps\n",
      "[-0.02375357  0.00082273  0.01775691 -0.04396887]\n",
      "[-0.02373712  0.19568561  0.01687753 -0.33099685]\n",
      "[-0.0198234   0.3905633   0.01025759 -0.61831   ]\n",
      "[-0.01201214  0.19529958 -0.00210861 -0.32241415]\n",
      "[-0.00810615  0.00020772 -0.00855689 -0.03039694]\n",
      "[-0.00810199 -0.19479048 -0.00916483  0.25957396]\n",
      "[-0.0119978  -0.38978041 -0.00397335  0.54935214]\n",
      "[-0.01979341 -0.58484632  0.00701369  0.84078054]\n",
      "[-0.03149034 -0.38982082  0.0238293   0.55031149]\n",
      "[-0.03928675 -0.19504153  0.03483553  0.26523067]\n",
      "[-0.04318758 -0.00043365  0.04014015 -0.01626448]\n",
      "[-0.04319626 -0.19610759  0.03981486  0.28880804]\n",
      "[-0.04711841 -0.00157535  0.04559102  0.00894341]\n",
      "[-0.04714992  0.19286412  0.04576989 -0.26901362]\n",
      "[-0.04329263  0.38730402  0.04038961 -0.54691639]\n",
      "[-0.03554655  0.58183593  0.02945129 -0.82660496]\n",
      "[-0.02390983  0.38632389  0.01291919 -0.52480664]\n",
      "[-0.01618336  0.58126167  0.00242305 -0.81339078]\n",
      "[-0.00455812  0.77635035 -0.01384476 -1.10531056]\n",
      "[ 0.01096888  0.58141316 -0.03595097 -0.81700303]\n",
      "[ 0.02259715  0.77700836 -0.05229103 -1.12077356]\n",
      "[ 0.03813731  0.97277569 -0.0747065  -1.42938973]\n",
      "[ 0.05759283  0.77865151 -0.1032943  -1.16095893]\n",
      "[ 0.07316586  0.58501549 -0.12651348 -0.9023676 ]\n",
      "[ 0.08486617  0.39181345 -0.14456083 -0.65197652]\n",
      "[ 0.09270244  0.58862126 -0.15760036 -0.98646197]\n",
      "[ 0.10447486  0.39592061 -0.1773296  -0.74713621]\n",
      "[ 0.11239328  0.2036306  -0.19227232 -0.51508646]\n",
      "[ 0.11646589  0.40086612 -0.20257405 -0.86166832]\n",
      "Episode finished after 29 timesteps\n",
      "[-0.0498491  -0.01556414  0.03609445  0.03405545]\n",
      "[-0.05016039  0.17902211  0.03677556 -0.24702435]\n",
      "[-0.04657994  0.37360006  0.03183507 -0.52788436]\n",
      "[-0.03910794  0.17804501  0.02127738 -0.22534248]\n",
      "[-0.03554704 -0.01737447  0.01677053  0.07397547]\n",
      "[-0.03589453  0.17750309  0.01825004 -0.21336946]\n",
      "[-0.03234447 -0.01787497  0.01398265  0.08501403]\n",
      "[-0.03270197  0.17704379  0.01568293 -0.20322475]\n",
      "[-0.02916109 -0.01829889  0.01161844  0.09436383]\n",
      "[-0.02952707 -0.21358543  0.01350572  0.3906896 ]\n",
      "[-0.03379878 -0.01865773  0.02131951  0.10229529]\n",
      "[-0.03417193 -0.21407863  0.02336541  0.40162748]\n",
      "[-0.03845351 -0.40952407  0.03139796  0.70158442]\n",
      "[-0.04664399 -0.21485108  0.04542965  0.41894835]\n",
      "[-0.05094101 -0.02040133  0.05380862  0.14092638]\n",
      "[-0.05134904  0.17391034  0.05662715 -0.13430716]\n",
      "[-0.04787083 -0.02197509  0.053941    0.17568949]\n",
      "[-0.04831033 -0.21782585  0.05745479  0.48488931]\n",
      "[-0.05266685 -0.41370954  0.06715258  0.79511243]\n",
      "[-0.06094104 -0.60968571  0.08305483  1.10814215]\n",
      "[-0.07313475 -0.80579518  0.10521767  1.4256824 ]\n",
      "[-0.08925066 -0.61211914  0.13373132  1.16765191]\n",
      "[-0.10149304 -0.80870314  0.15708436  1.49909496]\n",
      "[-0.1176671  -1.00534591  0.18706626  1.83642051]\n",
      "Episode finished after 24 timesteps\n",
      "[-0.02766684  0.00413949 -0.00116414  0.03758085]\n",
      "[-0.02758405 -0.19096575 -0.00041253  0.32989626]\n",
      "[-0.03140337  0.00416207  0.0061854   0.03708327]\n",
      "[-0.03132013  0.19919478  0.00692706 -0.2536417 ]\n",
      "[-0.02733623  0.00397461  0.00185423  0.04121807]\n",
      "[-0.02725674 -0.19117388  0.00267859  0.33448545]\n",
      "[-0.03108022 -0.38633385  0.0093683   0.62801186]\n",
      "[-0.03880689 -0.58158529  0.02192854  0.92363041]\n",
      "[-0.0504386  -0.38676633  0.04040115  0.6379187 ]\n",
      "[-0.05817393 -0.58242767  0.05315952  0.94304592]\n",
      "[-0.06982248 -0.38806072  0.07202044  0.66752889]\n",
      "[-0.07758369 -0.19401032  0.08537102  0.39836356]\n",
      "[-0.0814639  -0.39023309  0.09333829  0.71669438]\n",
      "[-0.08926856 -0.19651841  0.10767218  0.45478881]\n",
      "[-0.09319893 -0.00307051  0.11676795  0.19789185]\n",
      "[-0.09326034  0.1902045   0.12072579 -0.05579465]\n",
      "[-0.08945625  0.38340717  0.1196099  -0.30808208]\n",
      "[-0.08178811  0.57663979  0.11344825 -0.56077859]\n",
      "[-0.07025531  0.77000206  0.10223268 -0.81567522]\n",
      "[-0.05485527  0.57364003  0.08591918 -0.49266596]\n",
      "[-0.04338247  0.37741797  0.07606586 -0.17418944]\n",
      "[-0.03583411  0.57137353  0.07258207 -0.4419397 ]\n",
      "[-0.02440664  0.76539736  0.06374328 -0.71088877]\n",
      "[-0.00909869  0.95958136  0.0495255  -0.98284539]\n",
      "[ 0.01009294  1.15400599  0.02986859 -1.2595702 ]\n",
      "[ 0.03317305  1.34873336  0.00467719 -1.54275091]\n",
      "[ 0.06014772  1.54379878 -0.02617783 -1.83397075]\n",
      "[ 0.0910237   1.7392003  -0.06285724 -2.13466802]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.1258077   1.93488559 -0.10555061 -2.44608413]\n",
      "[ 0.16450542  2.13073601 -0.15447229 -2.76919911]\n",
      "Episode finished after 30 timesteps\n",
      "[ 0.01062378  0.03611278 -0.03679033 -0.02893028]\n",
      "[ 0.01134603 -0.15846279 -0.03736894  0.25192165]\n",
      "[ 0.00817678 -0.35303176 -0.0323305   0.53258744]\n",
      "[ 0.00111614 -0.54768443 -0.02167875  0.81491035]\n",
      "[-0.00983755 -0.35227243 -0.00538055  0.51548817]\n",
      "[-0.016883   -0.5473182   0.00492922  0.80647072]\n",
      "[-0.02782936 -0.74250737  0.02105863  1.1007001 ]\n",
      "[-0.04267951 -0.54766877  0.04307263  0.81469778]\n",
      "[-0.05363288 -0.35316229  0.05936659  0.5358681 ]\n",
      "[-0.06069613 -0.15892315  0.07008395  0.2624662 ]\n",
      "[-0.06387459 -0.35497187  0.07533327  0.57640518]\n",
      "[-0.07097403 -0.55106446  0.08686138  0.89183687]\n",
      "[-0.08199532 -0.74725052  0.10469811  1.21051165]\n",
      "[-0.09694033 -0.94355677  0.12890835  1.53408364]\n",
      "[-0.11581146 -1.13997438  0.15959002  1.86405967]\n",
      "[-0.13861095 -0.94692053  0.19687121  1.6248793 ]\n",
      "Episode finished after 16 timesteps\n",
      "[-0.02086412  0.04036353 -0.0438972  -0.00173644]\n",
      "[-0.02005685 -0.15410227 -0.04393193  0.27677964]\n",
      "[-0.0231389   0.04161801 -0.03839634 -0.02942936]\n",
      "[-0.02230654 -0.15293288 -0.03898493  0.25089613]\n",
      "[-0.02536519  0.04272347 -0.03396701 -0.05382406]\n",
      "[-0.02451073  0.23831558 -0.03504349 -0.35702738]\n",
      "[-0.01974441  0.04370891 -0.04218403 -0.07559728]\n",
      "[-0.01887024 -0.1507837  -0.04369598  0.20348368]\n",
      "[-0.02188591  0.04493503 -0.03962631 -0.10265671]\n",
      "[-0.02098721  0.24060181 -0.04167944 -0.40757356]\n",
      "[-0.01617517  0.4362892  -0.04983091 -0.71309994]\n",
      "[-0.00744939  0.24189129 -0.06409291 -0.43650927]\n",
      "[-0.00261156  0.04773239 -0.0728231  -0.16469931]\n",
      "[-0.00165692  0.24381716 -0.07611708 -0.47943798]\n",
      "[ 0.00321943  0.4399265  -0.08570584 -0.79510705]\n",
      "[ 0.01201796  0.24607882 -0.10160798 -0.53056949]\n",
      "[ 0.01693953  0.05252193 -0.11221937 -0.27155297]\n",
      "[ 0.01798997 -0.14083475 -0.11765043 -0.01626557]\n",
      "[ 0.01517328 -0.33409015 -0.11797574  0.23710413]\n",
      "[ 0.00849148 -0.13749765 -0.11323366 -0.09033929]\n",
      "[ 0.00574152  0.05904988 -0.11504045 -0.41649213]\n",
      "[ 0.00692252 -0.13426978 -0.12337029 -0.16217669]\n",
      "[ 0.00423712 -0.32742945 -0.12661382  0.08918173]\n",
      "[-0.00231146 -0.13074148 -0.12483019 -0.24061363]\n",
      "[-0.00492629  0.06592207 -0.12964246 -0.56991839]\n",
      "[-0.00360785 -0.12716622 -0.14104083 -0.3207247 ]\n",
      "[-0.00615118 -0.3200274  -0.14745532 -0.0756342 ]\n",
      "[-0.01255173 -0.12313305 -0.14896801 -0.41096565]\n",
      "[-0.01501439  0.07375206 -0.15718732 -0.74665729]\n",
      "[-0.01353935  0.27065316 -0.17212047 -1.0843907 ]\n",
      "[-0.00812628  0.46757595 -0.19380828 -1.42576415]\n",
      "Episode finished after 31 timesteps\n",
      "[-0.04502852 -0.04812433  0.03608779  0.04990093]\n",
      "[-0.04599101  0.14646207  0.03708581 -0.23118112]\n",
      "[-0.04306177 -0.04916964  0.03246219  0.07296541]\n",
      "[-0.04404516 -0.24474158  0.0339215   0.37571097]\n",
      "[-0.04893999 -0.05011745  0.04143572  0.09391372]\n",
      "[-0.04994234  0.14438687  0.04331399 -0.18541371]\n",
      "[-0.0470546   0.33886318  0.03960572 -0.46412425]\n",
      "[-0.04027734  0.14320459  0.03032323 -0.15922548]\n",
      "[-0.03741325  0.33787958  0.02713872 -0.44219006]\n",
      "[-0.03065565  0.14238432  0.01829492 -0.14107735]\n",
      "[-0.02780797  0.33723954  0.01547338 -0.42793285]\n",
      "[-0.02106318  0.53213896  0.00691472 -0.715698  ]\n",
      "[-0.0104204   0.33692199 -0.00739924 -0.42084663]\n",
      "[-0.00368196  0.14190565 -0.01581617 -0.13050549]\n",
      "[-0.00084385 -0.05298621 -0.01842628  0.15714597]\n",
      "[-0.00190357  0.14239465 -0.01528336 -0.14129258]\n",
      "[ 0.00094432  0.33773211 -0.01810922 -0.43875769]\n",
      "[ 0.00769897  0.14287109 -0.02688437 -0.15183791]\n",
      "[ 0.01055639  0.33836748 -0.02992113 -0.45287957]\n",
      "[ 0.01732374  0.14368115 -0.03897872 -0.16977628]\n",
      "[ 0.02019736 -0.05086184 -0.04237425  0.1103597 ]\n",
      "[ 0.01918012  0.1448409  -0.04016705 -0.19538519]\n",
      "[ 0.02207694  0.3405137  -0.04407476 -0.50046359]\n",
      "[ 0.02888722  0.53622836 -0.05408403 -0.80670427]\n",
      "[ 0.03961178  0.34188778 -0.07021811 -0.53151259]\n",
      "[ 0.04644954  0.5379235  -0.08084836 -0.84546872]\n",
      "[ 0.05720801  0.34399222 -0.09775774 -0.57926553]\n",
      "[ 0.06408785  0.15036636 -0.10934305 -0.31890845]\n",
      "[ 0.06709518  0.34686194 -0.11572122 -0.64397444]\n",
      "[ 0.07403242  0.5433903  -0.12860071 -0.9707415 ]\n",
      "[ 0.08490022  0.73998181 -0.14801554 -1.30089816]\n",
      "[ 0.09969986  0.9366392  -0.1740335  -1.63601662]\n",
      "[ 0.11843264  1.13332329 -0.20675383 -1.97749416]\n",
      "Episode finished after 33 timesteps\n",
      "[-0.04189426  0.02010084  0.00208691  0.01639306]\n",
      "[-0.04149224  0.2151928   0.00241477 -0.27563069]\n",
      "[-0.03718838  0.41028022 -0.00309784 -0.56755102]\n",
      "[-0.02898278  0.60544548 -0.01444886 -0.86120828]\n",
      "[-0.01687387  0.80076119 -0.03167303 -1.15839907]\n",
      "[-8.58646445e-04  9.96281267e-01 -5.48410107e-02 -1.46084241e+00]\n",
      "[ 0.01906698  0.80187286 -0.08405786 -1.18578338]\n",
      "[ 0.03510444  0.6079356  -0.10777353 -0.92058854]\n",
      "[ 0.04726315  0.41442224 -0.1261853  -0.66362674]\n",
      "[ 0.05555159  0.61105277 -0.13945783 -0.99322759]\n",
      "[ 0.06777265  0.41804412 -0.15932238 -0.74739318]\n",
      "[ 0.07613353  0.22543687 -0.17427025 -0.50878423]\n",
      "[ 0.08064227  0.03314314 -0.18444593 -0.27568904]\n",
      "[ 0.08130513 -0.15893404 -0.18995971 -0.04638045]\n",
      "[ 0.07812645 -0.35089637 -0.19088732  0.18087059]\n",
      "[ 0.07110852 -0.15362849 -0.18726991 -0.16543722]\n",
      "[ 0.06803595 -0.34564504 -0.19057865  0.06281572]\n",
      "[ 0.06112305 -0.14837429 -0.18932234 -0.28342453]\n",
      "[ 0.05815557 -0.34036271 -0.19499083 -0.05591643]\n",
      "[ 0.05134831 -0.14305724 -0.19610916 -0.40323078]\n",
      "[ 0.04848717  0.05422665 -0.20417377 -0.75077159]\n",
      "Episode finished after 21 timesteps\n",
      "[ 0.01725338 -0.04035665 -0.0019278   0.04367053]\n",
      "[ 0.01644624 -0.2354509  -0.00105439  0.33574459]\n",
      "[ 0.01173723 -0.04031396  0.0056605   0.04272935]\n",
      "[ 0.01093095  0.15472637  0.00651509 -0.24816227]\n",
      "[ 0.01402547 -0.04048802  0.00155184  0.04656852]\n",
      "[ 0.01321571  0.15461164  0.00248321 -0.24562438]\n",
      "[ 0.01630795  0.34969804 -0.00242927 -0.53752301]\n",
      "[ 0.02330191  0.15461033 -0.01317973 -0.24560651]\n",
      "[ 0.02639411  0.34991802 -0.01809186 -0.54241733]\n",
      "[ 0.03339247  0.15505495 -0.02894021 -0.25548928]\n",
      "[ 0.03649357 -0.03964211 -0.03405     0.02792678]\n",
      "[ 0.03570073  0.15595118 -0.03349146 -0.27530186]\n",
      "[ 0.03881975 -0.03867732 -0.0389975   0.00663253]\n",
      "[ 0.03804621  0.15698158 -0.03886485 -0.29809504]\n",
      "[ 0.04118584 -0.03756543 -0.04482675 -0.01791828]\n",
      "[ 0.04043453 -0.2320168  -0.04518511  0.26029112]\n",
      "[ 0.03579419 -0.42646557 -0.03997929  0.53838667]\n",
      "[ 0.02726488 -0.62100333 -0.02921156  0.81820936]\n",
      "[ 0.01484482 -0.81571351 -0.01284737  1.10156304]\n",
      "[-0.00146945 -0.6204249   0.00918389  0.80487727]\n",
      "[-0.01387795 -0.81567154  0.02528143  1.10043492]\n",
      "[-0.03019138 -1.01111691  0.04729013  1.40094123]\n",
      "[-0.05041372 -0.81661344  0.07530896  1.12341033]\n",
      "[-0.06674599 -1.01263753  0.09777716  1.43873295]\n",
      "[-0.08699874 -0.81884691  0.12655182  1.17813616]\n",
      "[-0.10337568 -1.01536451  0.15011455  1.50766223]\n",
      "[-0.12368297 -0.82234745  0.18026779  1.26536077]\n",
      "[-0.14012992 -1.01925583  0.20557501  1.60864936]\n",
      "Episode finished after 28 timesteps\n",
      "[0.00213841 0.02526882 0.02555132 0.00815358]\n",
      "[ 0.00264378 -0.17021007  0.0257144   0.30878749]\n",
      "[-0.00076042  0.02453623  0.03189015  0.02432381]\n",
      "[-0.0002697   0.21918668  0.03237662 -0.2581293 ]\n",
      "[0.00411404 0.02361782 0.02721404 0.04458731]\n",
      "[ 0.00458639 -0.17188358  0.02810578  0.34573077]\n",
      "[ 0.00114872 -0.36739382  0.0350204   0.64714232]\n",
      "[-0.00619915 -0.56298576  0.04796324  0.95064423]\n",
      "[-0.01745887 -0.36854105  0.06697613  0.67340837]\n",
      "[-0.02482969 -0.56452682  0.0804443   0.98640418]\n",
      "[-0.03612023 -0.76062856  0.10017238  1.30323064]\n",
      "[-0.0513328  -0.56690968  0.12623699  1.04351047]\n",
      "[-0.06267099 -0.37366936  0.1471072   0.79297168]\n",
      "[-0.07014438 -0.57047143  0.16296664  1.12808006]\n",
      "[-0.08155381 -0.76730883  0.18552824  1.46712451]\n",
      "Episode finished after 15 timesteps\n",
      "[ 0.01865495 -0.04773662 -0.00932119 -0.01514773]\n",
      "[ 0.01770022  0.14751776 -0.00962415 -0.31075697]\n",
      "[ 0.02065057  0.34277549 -0.01583929 -0.60645947]\n",
      "[ 0.02750608  0.5381153  -0.02796848 -0.90408897]\n",
      "[ 0.03826839  0.34338309 -0.04605026 -0.62032656]\n",
      "[ 0.04513605  0.1489335  -0.05845679 -0.34249538]\n",
      "[ 0.04811472  0.34483629 -0.0653067  -0.65302413]\n",
      "[ 0.05501145  0.15068162 -0.07836718 -0.38159948]\n",
      "[ 0.05802508  0.34682379 -0.08599917 -0.69792614]\n",
      "[ 0.06496156  0.15299294 -0.09995769 -0.43350695]\n",
      "[ 0.06802142 -0.04058225 -0.10862783 -0.1739322 ]\n",
      "[ 0.06720977  0.15591317 -0.11210647 -0.49881186]\n",
      "[ 0.07032803 -0.03746452 -0.12208271 -0.24345648]\n",
      "[ 0.06957874 -0.23065038 -0.12695184  0.0083623 ]\n",
      "[ 0.06496574 -0.42374467 -0.12678459  0.25844917]\n",
      "[ 0.05649084 -0.6168501  -0.12161561  0.5086075 ]\n",
      "[ 0.04415384 -0.81006759 -0.11144346  0.76062615]\n",
      "[ 0.02795249 -1.0034922  -0.09623094  1.01626664]\n",
      "[ 0.00788264 -0.80722806 -0.0759056   0.69498422]\n",
      "[-0.00826192 -1.00121969 -0.06200592  0.96283897]\n",
      "[-0.02828631 -0.80532185 -0.04274914  0.65133885]\n",
      "[-0.04439275 -0.6096314  -0.02972236  0.34550693]\n",
      "[-0.05658538 -0.80431822 -0.02281223  0.62867109]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-0.07267174 -0.60888546 -0.0102388   0.328892  ]\n",
      "[-0.08484945 -0.80386016 -0.00366096  0.61832858]\n",
      "[-0.10092665 -0.99893079  0.00870561  0.90985623]\n",
      "[-0.12090527 -1.19416947  0.02690273  1.20526257]\n",
      "[-0.14478866 -0.99940534  0.05100798  0.92113055]\n",
      "[-0.16477676 -1.19517811  0.0694306   1.22939761]\n",
      "[-0.18868033 -1.00101478  0.09401855  0.95925052]\n",
      "[-0.20870062 -1.19726633  0.11320356  1.27992847]\n",
      "[-0.23264595 -1.39363406  0.13880213  1.60580554]\n",
      "[-0.26051863 -1.59009792  0.17091824  1.93834399]\n",
      "Episode finished after 33 timesteps\n",
      "[-0.00891306 -0.03847526  0.02276513 -0.01518683]\n",
      "[-0.00968256  0.15631294  0.0224614  -0.30060105]\n",
      "[-0.0065563   0.35110766  0.01644938 -0.58611633]\n",
      "[ 0.00046585  0.15575922  0.00472705 -0.28829742]\n",
      "[ 0.00358104 -0.03942982 -0.0010389   0.00587262]\n",
      "[ 0.00279244  0.15570701 -0.00092145 -0.28713791]\n",
      "[ 0.00590658 -0.03940179 -0.0066642   0.00525426]\n",
      "[ 0.00511854  0.1558151  -0.00655912 -0.28952384]\n",
      "[ 0.00823485  0.35102997 -0.0123496  -0.5842682 ]\n",
      "[ 0.01525545  0.54632272 -0.02403496 -0.88081568]\n",
      "[ 0.0261819   0.74176279 -0.04165127 -1.1809567 ]\n",
      "[ 0.04101716  0.93739991 -0.06527041 -1.48639981]\n",
      "[ 0.05976515  0.74313126 -0.0949984  -1.21479321]\n",
      "[ 0.07462778  0.54935455 -0.11929427 -0.95332629]\n",
      "[ 0.08561487  0.74586199 -0.13836079 -1.28098193]\n",
      "[ 0.10053211  0.9424486  -0.16398043 -1.6135922 ]\n",
      "[ 0.11938108  1.13908224 -0.19625228 -1.95258047]\n",
      "Episode finished after 17 timesteps\n",
      "[ 0.01750237  0.03819477 -0.04388408 -0.0068425 ]\n",
      "[ 0.01826627 -0.15627125 -0.04402093  0.27167791]\n",
      "[ 0.01514084  0.03945031 -0.03858737 -0.03455799]\n",
      "[ 0.01592985 -0.15509765 -0.03927853  0.24570485]\n",
      "[ 0.0128279  -0.34963723 -0.03436444  0.52574422]\n",
      "[ 0.00583515 -0.15404899 -0.02384955  0.22243392]\n",
      "[ 0.00275417 -0.34882208 -0.01940087  0.50749936]\n",
      "[-0.00422227 -0.54366537 -0.00925089  0.7940058 ]\n",
      "[-0.01509558 -0.34841767  0.00662923  0.49842706]\n",
      "[-0.02206393 -0.54363246  0.01659777  0.79319179]\n",
      "[-0.03293658 -0.34874224  0.03246161  0.50577625]\n",
      "[-0.03991142 -0.15409241  0.04257713  0.22349736]\n",
      "[-0.04299327 -0.34979623  0.04704708  0.52930094]\n",
      "[-0.0499892  -0.54554737  0.0576331   0.83642949]\n",
      "[-0.06090014 -0.35125799  0.07436169  0.56241404]\n",
      "[-0.0679253  -0.15725399  0.08560997  0.29405445]\n",
      "[-0.07107038 -0.35348553  0.09149106  0.61246238]\n",
      "[-0.07814009 -0.15975328  0.1037403   0.34994025]\n",
      "[-0.08133516 -0.35618586  0.11073911  0.67345001]\n",
      "[-0.08845888 -0.16276307  0.12420811  0.41758378]\n",
      "[-0.09171414 -0.35940617  0.13255979  0.7466994 ]\n",
      "[-0.09890226 -0.55608373  0.14749377  1.07798605]\n",
      "[-0.11002394 -0.36318473  0.16905349  0.83498527]\n",
      "[-0.11728763 -0.56016278  0.1857532   1.17570563]\n",
      "[-0.12849089 -0.3678748   0.20926731  0.94653335]\n",
      "Episode finished after 25 timesteps\n",
      "[ 0.00307711 -0.04901699  0.03029534 -0.04057165]\n",
      "[ 0.00209677  0.14565773  0.02948391 -0.32354426]\n",
      "[ 0.00500993  0.34034772  0.02301302 -0.6067853 ]\n",
      "[ 0.01181688  0.14491168  0.01087732 -0.30694363]\n",
      "[ 0.01471511 -0.05036357  0.00473845 -0.01085023]\n",
      "[ 0.01370784 -0.24555315  0.00452144  0.28332396]\n",
      "[ 0.00879678 -0.4407393   0.01018792  0.57742949]\n",
      "[-1.80061817e-05 -2.45761616e-01  2.17365101e-02  2.87973339e-01]\n",
      "[-0.00493324 -0.05095628  0.02749598  0.00222439]\n",
      "[-0.00595236  0.14376077  0.02754046 -0.28165799]\n",
      "[-0.00307715  0.33847928  0.0219073  -0.56552911]\n",
      "[ 0.00369244  0.14305694  0.01059672 -0.26602572]\n",
      "[ 0.00655358 -0.05221463  0.00527621  0.02998058]\n",
      "[ 0.00550928 -0.24741185  0.00587582  0.32432353]\n",
      "[ 0.00056105 -0.05237405  0.01236229  0.03349937]\n",
      "[-0.00048643  0.14256846  0.01303228 -0.25525763]\n",
      "[ 0.00236493 -0.05273712  0.00792713  0.04150724]\n",
      "[ 0.00131019 -0.24797184  0.00875727  0.33668067]\n",
      "[-0.00364924 -0.44321731  0.01549088  0.63211225]\n",
      "[-0.01251359 -0.63855192  0.02813313  0.92963315]\n",
      "[-0.02528463 -0.44382079  0.04672579  0.64592208]\n",
      "[-0.03416105 -0.24938001  0.05964423  0.36831162]\n",
      "[-0.03914865 -0.05515402  0.06701047  0.09501571]\n",
      "[-0.04025173  0.13894669  0.06891078 -0.17579557]\n",
      "[-0.03747279  0.33301823  0.06539487 -0.44596823]\n",
      "[-0.03081243  0.52715701  0.0564755  -0.71734156]\n",
      "[-0.02026929  0.72145379  0.04212867 -0.99172709]\n",
      "[-0.00584021  0.52579417  0.02229413 -0.6861159 ]\n",
      "[ 0.00467567  0.72059965  0.00857181 -0.97169758]\n",
      "[ 0.01908766  0.52536372 -0.01086214 -0.67633436]\n",
      "[ 0.02959494  0.33039437 -0.02438883 -0.38709099]\n",
      "[ 0.03620283  0.13562696 -0.03213065 -0.10219637]\n",
      "[ 0.03891537  0.3311943  -0.03417457 -0.40484075]\n",
      "[ 0.04553925  0.52678381 -0.04227139 -0.70809908]\n",
      "[ 0.05607493  0.72246503 -0.05643337 -1.0137828 ]\n",
      "[ 0.07052423  0.52813938 -0.07670903 -0.73934096]\n",
      "[ 0.08108702  0.33415573 -0.09149585 -0.47175149]\n",
      "[ 0.08777013  0.53044282 -0.10093088 -0.79181283]\n",
      "[ 0.09837899  0.72679496 -0.11676713 -1.11446545]\n",
      "[ 0.11291489  0.53338335 -0.13905644 -0.86057519]\n",
      "[ 0.12358255  0.34040121 -0.15626794 -0.61464716]\n",
      "[ 0.13039058  0.1477681  -0.16856089 -0.37497437]\n",
      "[ 0.13334594  0.34483309 -0.17606038 -0.71570497]\n",
      "[ 0.1402426   0.54189825 -0.19037447 -1.05822794]\n",
      "Episode finished after 44 timesteps\n",
      "[-0.01129092 -0.03463472 -0.0080132   0.01912233]\n",
      "[-0.01198361  0.16060123 -0.00763075 -0.27607804]\n",
      "[-0.00877159 -0.03441102 -0.01315231  0.0141884 ]\n",
      "[-0.00945981 -0.22934191 -0.01286854  0.30269277]\n",
      "[-0.01404665 -0.03403894 -0.00681469  0.00597933]\n",
      "[-0.01472743  0.16118008 -0.0066951  -0.2888459 ]\n",
      "[-0.01150383 -0.03384577 -0.01247202  0.00171796]\n",
      "[-0.01218074  0.16145281 -0.01243766 -0.2948738 ]\n",
      "[-0.00895169  0.35674985 -0.01833514 -0.59145328]\n",
      "[-0.00181669  0.55212363 -0.0301642  -0.88985492]\n",
      "[ 0.00922578  0.74764161 -0.0479613  -1.1918654 ]\n",
      "[ 0.02417862  0.94335098 -0.07179861 -1.4991871 ]\n",
      "[ 0.04304564  0.74917101 -0.10178235 -1.22975823]\n",
      "[ 0.05802906  0.5554951  -0.12637751 -0.97062025]\n",
      "[ 0.06913896  0.75206591 -0.14578992 -1.30018114]\n",
      "[ 0.08418028  0.55906374 -0.17179354 -1.05645967]\n",
      "[ 0.09536155  0.75599403 -0.19292274 -1.39776603]\n",
      "Episode finished after 17 timesteps\n",
      "[ 0.0267244   0.02214605 -0.00884286  0.04062129]\n",
      "[ 0.02716732 -0.17284799 -0.00803044  0.33050114]\n",
      "[ 0.02371036 -0.36785471 -0.00142041  0.62064087]\n",
      "[ 0.01635327 -0.5629568   0.0109924   0.9128761 ]\n",
      "[ 0.00509413 -0.36798527  0.02924992  0.62366818]\n",
      "[-0.00226557 -0.17328365  0.04172329  0.34033893]\n",
      "[-0.00573124 -0.36897366  0.04853007  0.64588156]\n",
      "[-0.01311072 -0.56473705  0.0614477   0.95344318]\n",
      "[-0.02440546 -0.76062952  0.08051656  1.26478157]\n",
      "[-0.03961805 -0.56662362  0.10581219  0.9983618 ]\n",
      "[-0.05095052 -0.37306315  0.12577943  0.7406957 ]\n",
      "[-0.05841178 -0.1798814   0.14059334  0.49009395]\n",
      "[-0.06200941 -0.3766776   0.15039522  0.82357398]\n",
      "[-0.06954296 -0.18389767  0.1668667   0.58171795]\n",
      "[-0.07322092  0.00854173  0.17850106  0.34589978]\n",
      "[-0.07305008 -0.18861065  0.18541906  0.68913056]\n",
      "[-0.0768223   0.00352026  0.19920167  0.46007554]\n",
      "[-0.07675189  0.19535155  0.20840318  0.23619756]\n",
      "Episode finished after 18 timesteps\n",
      "[ 0.0298362  -0.01397061 -0.01980601  0.03446754]\n",
      "[ 0.02955678 -0.20880302 -0.01911666  0.32083624]\n",
      "[ 0.02538072 -0.40364758 -0.01269994  0.60742974]\n",
      "[ 0.01730777 -0.20835039 -0.00055134  0.31077389]\n",
      "[ 0.01314076 -0.01322059  0.00566414  0.01791714]\n",
      "[ 0.01287635 -0.20842331  0.00602248  0.31238177]\n",
      "[ 0.00870789 -0.40363054  0.01227012  0.60695791]\n",
      "[ 6.35274579e-04 -5.98921883e-01  2.44092738e-02  9.03480193e-01]\n",
      "[-0.01134316 -0.40413891  0.04247888  0.61856839]\n",
      "[-0.01942594 -0.59982766  0.05485025  0.92432176]\n",
      "[-0.03142249 -0.40548781  0.07333668  0.64936826]\n",
      "[-0.03953225 -0.60155059  0.08632405  0.96421359]\n",
      "[-0.05156326 -0.79771951  0.10560832  1.28271905]\n",
      "[-0.06751765 -0.60408912  0.1312627   1.02488281]\n",
      "[-0.07959944 -0.80069146  0.15176035  1.35572989]\n",
      "[-0.09561326 -0.60776425  0.17887495  1.11411167]\n",
      "[-0.10776855 -0.41538342  0.20115719  0.88245396]\n",
      "Episode finished after 17 timesteps\n"
     ]
    }
   ],
   "source": [
    "env = gym.make('CartPole-v0')\n",
    "for i_episode in range(20):\n",
    "    observation = env.reset()\n",
    "    for t in range(100):\n",
    "        env.render()\n",
    "        print(observation)\n",
    "        action = env.action_space.sample()\n",
    "        observation, reward, done, info = env.step(action)\n",
    "        if done:\n",
    "            print(\"Episode finished after {} timesteps\".format(t+1))\n",
    "            break\n",
    "env.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([-0.54059864, -0.9664389 , -0.36406725,  0.68493149])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "parameters = np.random.rand(4) * 2 - 1\n",
    "parameters"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "action = 0 if np.matmul(parameters,observation) < 0 else 1  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "def run_episode(env, parameters):  \n",
    "    observation = env.reset()\n",
    "    totalreward = 0\n",
    "    for _ in range(200):\n",
    "        action = 0 if np.matmul(parameters,observation) < 0 else 1\n",
    "        observation, reward, done, info = env.step(action)\n",
    "        totalreward += reward\n",
    "        if done:\n",
    "            break\n",
    "    return totalreward"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "2 techniques: Random Search and Hill-Climbing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "bestparams = None  \n",
    "bestreward = 0  \n",
    "for _ in range(10000):  \n",
    "    parameters = np.random.rand(4) * 2 - 1\n",
    "    reward = run_episode(env,parameters)\n",
    "    if reward > bestreward:\n",
    "        bestreward = reward\n",
    "        bestparams = parameters\n",
    "        # considered solved if the agent lasts 200 timesteps\n",
    "        if reward == 200:\n",
    "            break"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
